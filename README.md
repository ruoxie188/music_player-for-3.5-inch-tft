# 立创 ESP32S3R8N8 全彩触摸 MP3 播放器

**视频演示**：[【ESP32-S3 开发板 DIY 一个属于自己的 MP3】](https://www.bilibili.com/video/BV1xx4y1c7mC/)

## 项目介绍

本项目旨在**立创 ESP32S3R8N8 开发板**上，实现一个功能完整、界面美观的 MP3 音乐播放器。它以 ESP-IDF 为开发框架，深度整合了 LVGL 图形库、FATFS 文件系统以及板载的 ES8311 音频解码器驱动，将一块功能强大的物联网开发板，转变为一个独立的、交互体验优秀的便携式音乐中心。

项目的核心在于高效地协同处理三个关键任务：
1.  **文件系统交互**: 从 MicroSD (TF) 卡中扫描、读取 MP3 文件数据流。
2.  **音频解码与播放**: 将 MP3 数据流通过 I2S 总线发送给 ES8311 Codec 芯片进行实时解码和播放。
3.  **图形用户界面 (GUI)**: 使用 LVGL 构建流畅的触摸界面，响应用户操作（如播放/暂停、切歌、音量调节），并实时更新播放状态。

通过合理的任务调度和资源分配，本项目在资源有限的单片机平台上，实现了媲美消费级产品的稳定播放和顺滑操控体验。

## 基础硬件解析

立创 ESP32S3R8N8 开发板强大的硬件集成度是本项目成功的基石。它板载了实现一个高质量播放器所需的全部核心外设，无需任何外部扩展。

*   **高性能主控 (ESP32-S3-R8N8)**: 拥有强大的双核处理器和 8MB PSRAM，为 LVGL 图形渲染和多任务处理提供了坚实的算力保障。

*   **大尺寸电容触摸屏**: 板载一块 **480x320 分辨率的 3.5 寸彩色 LCD 屏**，并搭配 **FT5x06 电容式触摸控制器**。这是实现精美 UI 和流畅触摸交互的关键。项目中的 BSP (板级支持包) 提供了完善的 ST7796 (LCD 驱动) 和 FT5x06 (触摸驱动) 的封装，使上层应用调用极为便捷。

*   **完整的音频输出链路**: 开发板集成了一套高质量的音频硬件，这是实现高保真音乐播放的核心。该链路包括：
    *   **音频编解码芯片 (Audio Codec)**: 板载高性能的 **ES8311** 音频 Codec，负责将来自 ESP32-S3 的 I2S 数字音频信号，转换为高质量的模拟音频信号。
    *   **I2S 总线接口**: ESP32-S3 通过专用的 I2S (Inter-IC Sound) 总线与 ES8311 进行高效的数字音频数据传输。

*   **氛围灯效 (WS2812)**: 板载 8 颗可独立寻址的 WS2812 RGB LED，为后续扩展音乐频谱、律动灯效等酷炫功能预留了硬件接口。

## 如何使用

### 步骤一：准备 MicroSD 卡 (至关重要)

1.  请准备一张 MicroSD (TF) 卡。
2.  使用电脑将其格式化为 **FAT32** 文件系统。
3.  将你的 `.mp3` 格式音乐文件，直接拷贝到 SD 卡的 **根目录** 下。


### 步骤二：编译与烧录

连接开发板到电脑，然后执行以下命令即可完成编译、烧录和日志监控：

```bash
idf.py flash monitor```

烧录成功后，播放器将自动启动，扫描 SD 卡中的音乐文件并显示 UI 界面。

## 软件架构

本项目的软件架构清晰简洁，采用任务化的设计思路，将硬件驱动 (BSP) 与上层应用逻辑分离。

```c
hpy_mp3_player/
│
├── main/
│   │
│   ├── bsp/                # BSP 层：封装板载外设驱动
│   │   ├── esp32_s3_hpy.c
│   │   └── esp32_s3_hpy.h
│   │
│   ├── task/               # 应用任务层
│   │   ├── mp3_task.c      # MP3 文件扫描、解码与播放控制任务
│   │   ├── mp3_ui.c        # LVGL UI 创建、事件处理与刷新任务
│   │   └── ws2812_task.c   # WS2812 灯效控制任务
│   │
│   ├── main.c              # 程序主入口：初始化、创建任务
│   └── CMakeLists.txt
│
├── managed_components      # ESP-IDF 托管组件
├── sdkconfig               # 项目配置文件
└── CMakeLists.txt          # 顶层 CMake 构建文件
